---
import Custom from "./Custom.astro";
import Nav from "./Nav.astro";

const navBarSentinelId = "navbar-sentinel";
---

<div id={navBarSentinelId} class="h-[1px] w-full" />

<div
  class="flex flex-col md:flex-row fixed right-2 top-0 bottom-0 my-auto md:sticky md:top-4 md:right-0 md:left-0 md:mb-20 md:mx-auto size-max gap-x-4 gap-y-3 text-lg z-30"
>
  <Nav />
  <Custom />
</div>

<script>
  const navBarSentinel = document.getElementById("navbar-sentinel");
  
  const callback: IntersectionObserverCallback = ([entry]) => {
    const isSticky = !entry.isIntersecting;
    document.dispatchEvent(
      new CustomEvent("is-navbar-sticky", { detail: isSticky })
    );
  };

  const observer = new IntersectionObserver(callback, { threshold: 0.01 });
  if (navBarSentinel) observer.observe(navBarSentinel);
</script>
